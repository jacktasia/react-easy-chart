{"version":3,"sources":["../../modules/bar-chart/index.js"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import React from 'react';\nimport { ordinal, linear } from 'd3-scale';\nimport { event as d3LastEvent, select, time, svg, scale, max} from 'd3';\nimport {reduce, calcMargin, calcDefaultDomain, defaultStyle, createCircularTicks, getAxisStyles} from '../shared';\nimport {extent} from 'd3-array';\nimport {format} from 'd3-time-format';\nimport { createElement } from 'react-faux-dom';\nimport { Style } from 'radium';\nimport merge from 'lodash.merge';\n\nconst colorScale = scale.category20();\n\nexport default class BarChart extends React.Component {\n\n  static get propTypes() {\n    return {\n      data: React.PropTypes.array.isRequired,\n      width: React.PropTypes.number,\n      height: React.PropTypes.number,\n      margin: React.PropTypes.object,\n      mouseOverHandler: React.PropTypes.func,\n      mouseOutHandler: React.PropTypes.func,\n      mouseMoveHandler: React.PropTypes.func,\n      clickHandler: React.PropTypes.func,\n      style: React.PropTypes.object,\n      colorBars: React.PropTypes.bool,\n      axes: React.PropTypes.bool,\n      grid: React.PropTypes.bool,\n      axisLabels: React.PropTypes.object,\n      xType: React.PropTypes.string,\n      yType: React.PropTypes.string,\n      xDomainRange: React.PropTypes.array,\n      yDomainRange: React.PropTypes.array,\n      datePattern: React.PropTypes.string,\n      tickTimeDisplayFormat: React.PropTypes.string,\n      yAxisOrientRight: React.PropTypes.bool,\n      barWidth: React.PropTypes.number,\n      xTickNumber: React.PropTypes.number,\n      yTickNumber: React.PropTypes.number\n    };\n  }\n\n  static get defaultProps() {\n    return {\n      width: 400,\n      height: 200,\n      barWidth: 10,\n      axes: false,\n      xType: 'text',\n      yType: 'linear',\n      mouseOverHandler: () => {},\n      mouseOutHandler: () => {},\n      mouseMoveHandler: () => {},\n      clickHandler: () => {},\n      datePattern: '%d-%b-%y',\n      axisLabels: {x: '', y: ''}\n    };\n  }\n\n  constructor(props) {\n    super(props);\n    this.parseDate = format(props.datePattern).parse;\n    this.uid = Math.floor(Math.random() * new Date().getTime());\n  }\n\n  componentDidMount() {\n    createCircularTicks(this.refs[this.uid]);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.width !== prevProps.width) {\n      createCircularTicks(this.refs[this.uid]);\n    }\n  }\n\n  setScaleDomainRange(axesType, domainRange, data, type, length) {\n    const dataIndex = axesType === 'x' ? 'x' : 'y';\n    const barPadding = (length / data.length) > 40 ? 0.02 : 0.04;\n    let d3Axis;\n    switch (type) {\n      case 'text':\n        d3Axis = ordinal();\n        d3Axis.domain(data.map((d) => d[dataIndex]));\n        d3Axis.rangeBands([0, length], barPadding);\n        break;\n      case 'linear':\n        d3Axis = linear();\n        d3Axis.domain(domainRange ?\n          calcDefaultDomain(domainRange, type, this.parseDate)\n          :\n          [0, max(data, (d) => d[dataIndex])]\n        );\n        d3Axis.range(axesType === 'x' ? [0, length] : [length, 0]);\n        break;\n      case 'time':\n        d3Axis = time.scale();\n        d3Axis.domain(domainRange ?\n          calcDefaultDomain(domainRange, type, this.parseDate)\n          :\n          extent(data, (d) => this.parseDate(d[dataIndex]))\n        );\n        d3Axis.range(axesType === 'x' ? [0, length] : [length, 0]);\n        break;\n      default:\n        break;\n    }\n    return d3Axis;\n  }\n\n  defineColor(i, d, colorBars) {\n    if (d.color) return d.color;\n    if (colorBars) return colorScale(i);\n    return null;\n  }\n\n  render() {\n    const {\n      data,\n      mouseOverHandler,\n      mouseOutHandler,\n      mouseMoveHandler,\n      clickHandler,\n      style,\n      axes,\n      axisLabels,\n      colorBars,\n      xType,\n      yType,\n      barWidth,\n      tickTimeDisplayFormat,\n      xTickNumber,\n      yTickNumber,\n      yAxisOrientRight,\n      grid,\n      xDomainRange,\n      yDomainRange} = this.props;\n    const margin = calcMargin(axes, this.props.margin, yAxisOrientRight);\n    const width = reduce(this.props.width, margin.left, margin.right);\n    const height = reduce(this.props.height, margin.top, margin.bottom);\n\n    const x = this.setScaleDomainRange('x', xDomainRange, data, xType, width);\n    const y = this.setScaleDomainRange('y', yDomainRange, data, yType, height);\n\n    const svgNode = createElement('svg');\n    select(svgNode).attr('width', width + margin.left + margin.right).attr('height', height + margin.top + margin.bottom);\n    const root = select(svgNode).append('g').attr('transform', `translate(${margin.left},${margin.top})`);\n\n    if (axes) {\n      const xAxis = svg.axis()\n          .scale(x)\n          .orient('bottom');\n      if (xType === 'time' && tickTimeDisplayFormat) {\n        xAxis.tickFormat(time.format(tickTimeDisplayFormat));\n      }\n      xAxis.tickSize(0).tickPadding(15);\n      if (xTickNumber) xAxis.ticks(xTickNumber);\n      root.append('g')\n        .attr('class', 'x axis')\n        .attr('transform', 'translate(0,' + height + ')')\n        .call(xAxis)\n        .append('text')\n        .attr('class', 'label')\n        .attr('y', margin.bottom - 10)\n        .attr('x', yAxisOrientRight ? 0 : width)\n        .style('text-anchor', yAxisOrientRight ? 'start' : 'end')\n        .text(axisLabels.x);\n\n      const yAxis = svg.axis()\n          .scale(y)\n          .orient(yAxisOrientRight ? 'right' : 'left');\n      if (yTickNumber) yAxis.ticks(yTickNumber);\n      if (grid) { yAxis.tickSize(-width, 6).tickPadding(12); } else { yAxis.tickPadding(10); }\n      root.append('g')\n        .attr('class', 'y axis')\n        .call(yAxis)\n        .attr('transform', yAxisOrientRight ? `translate(${width}, 0)` : `translate(0, 0)`)\n        .append('text')\n        .attr('class', 'label')\n        .attr('transform', 'rotate(-90)')\n        .attr('x', 0)\n        .attr('y', yAxisOrientRight ? -25 + margin.right : 10 - margin.left)\n        .attr('dy', '.9em')\n        .style('text-anchor', 'end')\n        .text(axisLabels.y);\n    }\n\n    data.map(() => {\n      root.selectAll('.bar')\n          .data(data)\n          .enter()\n          .append('rect')\n          .attr('class', 'bar')\n          .style('fill', (d, i) => this.defineColor(i, d, colorBars))\n          .attr('x', (d) => {\n            switch (xType) {\n              case ('time'):\n                return x(this.parseDate(d.x));\n              default:\n                return x(d.x);\n            }\n          })\n          .attr('width', () => {\n            switch (xType) {\n              case ('text'):\n                return x.rangeBand();\n              default:\n                return barWidth;\n            }\n          })\n          .style('y', (d) => y(d.y))\n          .style('height', (d) => height - y(d.y))\n          .on('mouseover', (d) => mouseOverHandler(d, d3LastEvent))\n          .on('mouseout', (d) => mouseOutHandler(d, d3LastEvent))\n          .on('mousemove', () => mouseMoveHandler(d3LastEvent))\n          .on('click', (d) => clickHandler(d, d3LastEvent));\n    });\n\n    return (\n      <div ref={this.uid} className={`bar-chart${this.uid}`}>\n        <Style scopeSelector={`.bar-chart${this.uid}`} rules={merge({}, defaultStyle, style, getAxisStyles(grid, false, yAxisOrientRight))}/>\n        {svgNode.toReact()}\n      </div>\n    );\n  }\n}\n"]}